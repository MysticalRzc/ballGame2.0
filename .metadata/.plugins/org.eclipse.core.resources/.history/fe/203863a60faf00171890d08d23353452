package communication.udpCommunication;

import java.util.regex.Pattern;

public class UdpCommunnication {

	final private Thread reTh;
	final private Thread seTh;

	static String sendMess = "";

	public UdpCommunnication() {
		super();
		this.reTh = new Thread(new UdpReceiveThread(), "receiveThread");
		this.seTh = new Thread(new UdpSendThread("127.0.0.1", 5678),
				"sendThread");
	}

	public UdpCommunnication(String address,int port) {
		super();
		if(port<0 || port>=65535)
			port = 30000;
		else
		{
			String regEx = "^(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|[1-9])\\."
							+"(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|\\d)\\."
							+"(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|\\d)\\."
							+"(1\\d{2}|2[0-4]\\d|25[0-5]|[1-9]\\d|\\d)$";
			 Pattern pattern = Pattern.compile(regEx);
			 
			if(pattern.matches(address,regEx))
			{
				System.out.println("Yes");
			}
				
		}
		this.reTh = new Thread(new UdpReceiveThread(), "receiveThread");
		this.seTh = new Thread(new UdpSendThread(address, port),
				"sendThread");
	}

	public void receive() {
		reTh.start();
	}

	public void send(String mess) {
		if (!seTh.isAlive())
			seTh.start();
		sendMess = mess;
	}

	public void send(String mess, String address, int port) {
		if (!seTh.isAlive())
			seTh.start();
		sendMess = mess;

	}

	static protected void setMessage(String message) { // kid visited only
		System.out.println(message.substring(0, 8));
		System.out.println(message.substring(8));
	}
}
